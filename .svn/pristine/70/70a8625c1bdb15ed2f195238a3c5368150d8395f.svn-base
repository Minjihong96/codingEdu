package web.com.springweb.myeoncheol.smc01.a01_java;





import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;

import jakarta.servlet.http.HttpSession;
import web.com.springweb.gichan.gi04_vo.JoinMem;
import web.com.springweb.myeoncheol.vo.JoinMembership;


@Controller
public class Controllerclass {
	
	@Autowired(required = false)
	private Serviceclass service;
	
	// http://localhost:7070/mcStart3
	@RequestMapping("mcStart3")
	public String mcStart3() {
		return "WEB-INF\\views\\myoungcheol\\submitPage.jsp";
	}
	
	// http://localhost:7070/mclogin
	@GetMapping("mclogin")
	public String loginPage() {
	    return "WEB-INF\\views\\myoungcheol\\stumainmc.jsp"; // 로그인 폼으로 이동
	}
	@PostMapping("mclogin")
	public String loginProc(JoinMem loginReq, Model d, HttpSession session) {

		JoinMem user = service.selectMember(loginReq);
	    if (user != null) {
	        session.setAttribute("loginUser", user); // 세션에 저장

	        // accountType에 따라 리디렉션
	        String accountType = user.getAccountType();

	        if ("student".equalsIgnoreCase(accountType)) {
	            return "redirect:stuloginmc";
	        } else if ("admin".equalsIgnoreCase(accountType)) {
	            return "redirect:stumainmc";
	        } else if ("teacher".equalsIgnoreCase(accountType)) {
	            return "redirect:teamainmc";
	        } else {
	            // 알 수 없는 계정 유형
	            d.addAttribute("loginError", "알 수 없는 계정 유형입니다.");
	            return "WEB-INF\\views\\myoungcheol\\stumainmc.jsp";
	        }

	    } else {
	        // 로그인 실패
	        d.addAttribute("loginError", "아이디 또는 비밀번호가 틀렸습니다.");
	        return "WEB-INF\\views\\myoungcheol\\stumainmc.jsp";
	    }
	}
	@RequestMapping("stuloginmc")
	public String stumain() {
	    return "WEB-INF\\views\\myoungcheol\\stuloginmc.jsp";
	}
	@RequestMapping("adminmainmc")
	public String adminMain() {
	    return "WEB-INF\\views\\myoungcheol\\adminmainmc.jsp";
	}
	@RequestMapping("teamainmc")
	public String teaMain() {
	    return "WEB-INF\\views\\myoungcheol\\teamainmc.jsp";
	}
	
    @RequestMapping("logout")
    public String logout(HttpSession session) {
        session.invalidate(); // 세션 삭제
        return "redirect:stumainmc"; // 메인 페이지로 리다이렉트
    }

	
	// http://localhost:7070/mypage
	@RequestMapping("mypage")
	public String mypage() {
		return "WEB-INF\\views\\myoungcheol\\studentInfoList.jsp";
	}
	/* 호출 예시
	// http://localhost:7070/mcStart1
	@RequestMapping("mcStart1")
	public String mcStart1() {	// 요청값
		// 모델 데이터 설정
		
		// view 단 호출
		return "WEB-INF\\views\\myoungcheol\\index1.jsp";
	 */
	// http://localhost:7070/mcStart44
		@RequestMapping("mcStart44")
		public String mcStart44() {	// 요청값
			// 모델 데이터 설정
			
			// view 단 호출
			return "WEB-INF\\views\\myoungcheol\\main2.jsp";
		}
		@GetMapping("submitPage")
		public String submitPage() {
			
			return "WEB-INF\\views\\myoungcheol\\submitPage.jsp";
		}
		// http://localhost:7070/checkInfo
		@RequestMapping("checkInfo")
		public String checkInfo() {
			return "WEB-INF\\views\\myoungcheol\\studentInfoList.jsp";
		}
			// 회원 리스트
			// http://localhost:7070/getMemberList
		@RequestMapping("getMemberList")
		public String getMemberList(JoinMembership sch, Model d){
			d.addAttribute("memList", service.getMemberList(sch));
			
			return "WEB-INF\\views\\myoungcheol\\studentIListex.jsp";
		}
	
		// 회원 디테일
		// http://localhost:7070/getMemberDetail
		@GetMapping("getMemberDetail")
		public String getMemberDetail(@RequestParam("memPrid")int memPrid, Model d) {
			System.out.println("컨트롤에서 온 memPrid : "+ memPrid);
			d.addAttribute("mem", service.memberById(memPrid));
			
			return "WEB-INF\\views\\myoungcheol\\studentInfoList.jsp";
		}
		/* 
		// 고객 상세정보
	// http://localhost:5050/customerDetail
		@GetMapping("customerDetail")
		public String customerDetail(@RequestParam("customerId") int customerId, Model d) {
			System.out.println("컨트롤에 온 customerId:"+customerId);
			d.addAttribute("cus", service.getCustomer(customerId));
			return "WEB-INF\\views\\a04_mvc\\a03_customerDetail.jsp";
		}
		
		  'member'라는 이름의 Java Bean 객체가 Spring Controller의 Model을 통해 전달된다고 가정합니다.
              예: @GetMapping("/memberInfo") public String getMemberInfo(Model model) {
                  model.addAttribute("member", memberService.getLoggedInMember());
                  return "your_jsp_file";
		 */
		
		/*
	
*/
		
		
	/*
	 * // http://localhost:5050/customerList
	@RequestMapping("customerList")
	public String customerList(Customers sch, Model m) {
		m.addAttribute("cuList", service.getCustomersList(sch));
		
		return "WEB-INF\\views\\a04_mvc\\a01_customerList.jsp";
	}
	// http://localhost:7070/getStudentInfoList
	@RequestMapping("getStudentInfoList")
	public String getStudentInfoList(Student sch, Model d){
		d.addAttribute("stInfoList". service.getStudentInfoList(sch));
		
		return ""
	}
	 */
	
	
	/* 예시 구문
	// http://localhost:5050/customerList
	// 초기화면 호출 메서드 선언..
	@RequestMapping("customerList")
	public String customerList(Customer sch, Model d) {
		
		d.addAttribute("cuList", service.getCustomerList(sch));
		
		return "WEB-INF\\views\\a04_mvc\\a01_customerList.jsp";
	}
	// http://localhost:5050/customerInsert
	@RequestMapping("customerInsert")
	public String customerInsert() {
		return "WEB-INF\\views\\a04_mvc\\a02_customerInsert.jsp";
	}
	// http://localhost:5050/customerDetail
	@RequestMapping("customerDetail")
	public String customerDetail() {
		return "WEB-INF\\views\\a04_mvc\\a03_customerDetail.jsp";
	}
	 */
		
}
